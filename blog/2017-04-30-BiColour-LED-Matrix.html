<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Ethan McAuliffe</title><meta name="description" content="My personal website and blog"/><link rel="icon" href="/favicon.ico"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/1bf78e4fad6a32832712.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1bf78e4fad6a32832712.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6794465708b9ff3a7d52.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6794465708b9ff3a7d52.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-90a60b87fd0d5fc150f2.js" defer=""></script><script src="/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="/_next/static/chunks/main-9d5441e696c3e557f79f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2f2e40eeee33a42dbc14.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5BpostName%5D-16fec599cd3f1ade44b5.js" defer=""></script><script src="/_next/static/5zUs8AefGgLCYwo_St8mR/_buildManifest.js" defer=""></script><script src="/_next/static/5zUs8AefGgLCYwo_St8mR/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="Post_container__39vXa"><div class="Post_backButton__2By7j"><a href="/blog">◀ All Posts</a></div><h1>BiColour LED Matrix</h1><h2>Purpose</h2><p>The purpose of this project is to learn about low-level port manipulation using the ATtiny84 and a homemade bicolour LED matrix display. The LED matrix is to show a unique and challenging pattern. This project incorporates persistence of vision (POV), switching quickly between red and green to create a yellow colour and code that uses bitwise operators. The animations used will consist of a square counting down from four to zero, then a red dot flashing in sync with a buzzer; a series of firework-like explosion animations wherein the LEDs flash outwards in a cross from an origin; and a yellow sunrise and sunset animation.</p><table><thead><tr><th>Parts List</th><th></th></tr></thead><tbody><tr><td>ATtiny84 Through-Hole Microcontroller</td><td>16 × Red-Green BiColour LEDs</td></tr><tr><td>Piezo buzzer</td><td>AVR Pocket Programmer</td></tr><tr><td>AVR Programmer Breakout Board</td><td>Heat-Shrink Tubing</td></tr><tr><td>4 × Male to Female Jumper Wires</td><td></td></tr></tbody></table><h2>Procedure</h2><p>This project begins by soldering the LED matrix together using the 3D-Printed matrix jig (seen bottom right). The arrangement of the LEDs requires them to be in a particular orientation as to connect all the short pins and long pins together. They must be in this arrangement so that the code can address individual LEDs. Heat shrink tubing on each of the anode pins prevents them from short-circuiting with the bare cathode pins soldered beneath and displaying a unwanted pattern. Building the matrix requires the testing of each LED to ensure operation and prevent non-functional &quot;pixels&quot; on the matrix. Coloured heat shrink tubing added to the ends of the matrix pins differentiate the anode pins of each colour.</p><p>The code consists of four separate patterns: <code>countDownSquare()</code>, <code>explodeMatrix()</code>, <code>sunrise()</code>,<code>sunset()</code>. Code uploading utilizes the AVR Pocket Programmer.</p><a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/GarrowJig.png"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/GarrowJig.png"/></a>To begin, the `countDownSquare()` function displays a 2×2 square of green LEDs in the middle of the matrix. The function then uses POV to iterate through a series of display outputs. The POV used in this project utilizes the ability to set each individual port on each individual bus to input or output using the Data Direction Register (DDR). When a pin is set to output, it is either ground or VCC. When it is set to input, however, it is essentially &quot;hanging&quot; and will not ground or supply any voltage. This is how it is possible to individually address LEDs. The function continues the countdown, and then shows a blinking red LED in conjunction with a buzzer.<a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/Screen%20Shot%202018-01-31%20at%2011.46.12.png"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/Screen%20Shot%202018-01-31%20at%2011.46.12.png"/></a>The `explodeMatrix()` function is a special loop that calls the main `fireworks()` function with every individual LED as an origin point. The `fireworks()` function iterates through a loop itself where it fills the matrix with a specific colour, but uses the DDR to disable particular LEDs. The function uses the logical OR operator (see Project 2) on each individual bit (called bitwise) to calculate the required value in the DDR and show only the requested LED. By adding the loop variable to the specified `startingLEDY` and `startingLEDX`, the loop uses POV to light up LEDs in a outward moving &quot;cross&quot; pattern, thus simulating a firework-like explosion.<p>Finally, the <code>sunrise()</code> function utilises the <code>sunriseDDR[]</code> array to demonstrate that arrays can store patterns. First, the program iterates through a <code>while()</code> to ensure that specific display values appear for an accurate duration of time. The <code>countDownSquare()</code> function uses a similar loop to display POV patterns. The <code>while()</code> loop iterates through each element setting DDRA equal to the value of said element. Using the <code>sunriseFrames</code> variable in the loop prevents it from exceeding the maximum length of the array and breaking the pattern. To finish, the code iterates through the <code>sunriseDDR[]</code> array in reverse to show the sunset animation. The code then loops through the four patterns again.</p><h2>Media</h2><table><tr><td><a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0001.jpg"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0001.jpg"/></a></td><td><a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0002.jpg"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0002.jpg"/></a></td></tr><tr><th>Testing patterns on the matrix</th><th><code>countDownSquare()</code> animation</th></tr><tr><td><a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/20170427_213007.jpg"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/20170427_213007.jpg"/></a></td><td><a href="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0006.jpg"><img src="/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0006.jpg"/></a></td></tr><tr><th>AVR Programmer Breakout Board properly assembled</th><th>Final solder job of the BiColour LED Matrix</th></tr><tr><th colSpan="2">Link to YouTube Video: <a href="https://youtu.be/hrjuC2itXW4">https://youtu.be/hrjuC2itXW4</a></th></tr></table><h2>Code</h2><pre><code class="hljs language-arduino"><span class="hljs-meta">#<span class="hljs-keyword">define</span> RED 1</span>

<span class="hljs-type">uint8_t</span> sunriseDDR[] = {<span class="hljs-number">0x16</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xC6</span>};<span class="hljs-comment">//sunrise value array</span>
<span class="hljs-type">uint8_t</span> sunriseFrames = <span class="hljs-built_in">sizeof</span>(sunriseDDR) / <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint8_t</span>); <span class="hljs-comment">//calculates length of sunrise array in bytes</span>

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  DDRA = <span class="hljs-number">0xFF</span>;<span class="hljs-comment">//preemptively enables output for all matrix ports</span>
  DDRB = <span class="hljs-number">1</span> &lt;&lt; PORTB2;<span class="hljs-comment">//enables specific port on PORTB for buzzer</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-built_in">countDownSquare</span>(<span class="hljs-number">100</span>);
  <span class="hljs-built_in">explodeMatrix</span>();
  <span class="hljs-built_in">sunrise</span>(<span class="hljs-number">100</span>);
  <span class="hljs-built_in">sunset</span>(<span class="hljs-number">100</span>);
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">countDownSquare</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> countSpeed)</span> </span>{
  DDRA = <span class="hljs-number">0x66</span>;
  PORTA = <span class="hljs-number">0x60</span>; <span class="hljs-comment">//full green square</span>
  <span class="hljs-built_in">delay</span>(countSpeed);
  <span class="hljs-type">uint16_t</span> povTime = <span class="hljs-built_in">millis</span>();
  <span class="hljs-keyword">while</span> (povTime + <span class="hljs-number">200</span> &gt;= <span class="hljs-built_in">millis</span>()) { <span class="hljs-comment">//shows POV of 3 dots in centre of matrix</span>
    DDRA = <span class="hljs-number">0x22</span>;
    PORTA = <span class="hljs-number">0x20</span>; <span class="hljs-comment">//bottom left green dot</span>
    DDRA = <span class="hljs-number">0x64</span>;
    PORTA = <span class="hljs-number">0x60</span>; <span class="hljs-comment">//two green line left</span>
  }
  DDRA = <span class="hljs-number">0x64</span>;<span class="hljs-comment">//shows 2 dots on left side of matrix</span>
  <span class="hljs-built_in">delay</span>(countSpeed);
  DDRA = <span class="hljs-number">0x44</span>;<span class="hljs-comment">// shows upper left dot</span>
  <span class="hljs-built_in">delay</span>(countSpeed);
  DDRA = <span class="hljs-number">0x44</span>; <span class="hljs-comment">// keeps red dot in sync with other dots to be displayed</span>
  PORTA ^= <span class="hljs-number">0xFF</span>; <span class="hljs-comment">//invert colours of top left dot</span>
  DDRA ^= <span class="hljs-number">1</span> &lt;&lt; PORTA2;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> i; i &lt; <span class="hljs-number">8</span>; i++) {
    PORTB ^= <span class="hljs-number">1</span> &lt;&lt; PORTB2;<span class="hljs-comment">//turns on and off the buzzer</span>
    DDRA ^= <span class="hljs-number">1</span> &lt;&lt; PORTA2; <span class="hljs-comment">//turn on and off the top left dot</span>
    <span class="hljs-built_in">delay</span>(countSpeed);
  }
  DDRB = <span class="hljs-number">0x00</span>; <span class="hljs-comment">//turn off port as interference from other ports can cause noise in the buzzer</span>
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">firework</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> explosionSpeed, <span class="hljs-type">uint8_t</span> startingLEDY, <span class="hljs-type">uint8_t</span> startingLEDX)</span> </span>{
  <span class="hljs-built_in">matrix</span>(RED);
  <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">4</span>; i++) {
    <span class="hljs-type">uint16_t</span> povDuration = <span class="hljs-built_in">millis</span>() + explosionSpeed;
    <span class="hljs-keyword">while</span> (povDuration &gt;= <span class="hljs-built_in">millis</span>()) { <span class="hljs-comment">// uses POV and loop to show &quot;explosion&quot; animation where lit LEDs move out in a cross from the original LED</span>
      DDRA = <span class="hljs-number">1</span> &lt;&lt; startingLEDY + i | <span class="hljs-number">1</span> &lt;&lt; startingLEDX;
      DDRA = <span class="hljs-number">1</span> &lt;&lt; startingLEDY - i | <span class="hljs-number">1</span> &lt;&lt; startingLEDX;
      DDRA = <span class="hljs-number">1</span> &lt;&lt; startingLEDY | <span class="hljs-number">1</span> &lt;&lt; startingLEDX + i;
      (startingLEDX - i) &lt; <span class="hljs-number">0</span> ? DDRA = <span class="hljs-number">0x00</span> : DDRA = (<span class="hljs-number">1</span> &lt;&lt; startingLEDY | <span class="hljs-number">1</span> &lt;&lt; startingLEDX - i); <span class="hljs-comment">// if conditional is not used, the LED linked to PORTA0 will stay on, as negatives are not accepted</span>
    }
  }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">matrix</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> colour)</span> </span>{ <span class="hljs-comment">//sets matrix either all green or all red</span>
  colour == <span class="hljs-number">1</span> ? PORTA = <span class="hljs-number">0x0F</span> : PORTA = <span class="hljs-number">0xF0</span>;
}
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">explodeMatrix</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">//runs through a loop of firework animations; one animation per led on the matrix</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> j = <span class="hljs-number">4</span>; j &lt;= <span class="hljs-number">7</span>; j++) {
      <span class="hljs-built_in">firework</span>(<span class="hljs-number">40</span>, j, i);
    }
  }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sunrise</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> duration)</span> </span>{ <span class="hljs-comment">// animates sunrise array</span>
  PORTA = <span class="hljs-number">0x0F</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> i = <span class="hljs-number">0</span>; i &lt; sunriseFrames; i++) {
    <span class="hljs-type">uint16_t</span> povTime = <span class="hljs-built_in">millis</span>() + duration;
    <span class="hljs-keyword">while</span> (povTime &gt; <span class="hljs-built_in">millis</span>()) {
      DDRA = sunriseDDR[i];<span class="hljs-comment">//loops through array and displays appropriate value</span>
      PORTA ^= <span class="hljs-number">0xFF</span>;
    }
  }
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">sunset</span><span class="hljs-params">(<span class="hljs-type">uint16_t</span> duration)</span> </span>{
  PORTA = <span class="hljs-number">0x0F</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-type">uint8_t</span> i = sunriseFrames - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
    <span class="hljs-type">uint16_t</span> povTime = <span class="hljs-built_in">millis</span>() + duration;
    <span class="hljs-keyword">while</span> (povTime &gt; <span class="hljs-built_in">millis</span>()) {
      DDRA = sunriseDDR[i];<span class="hljs-comment">//loops through array and displays appropriate value</span>
      PORTA ^= <span class="hljs-number">0xFF</span>;
    }
  }
  DDRA = <span class="hljs-number">0x00</span>;
}
</code></pre><h2>Conclusion</h2><p>In conclusion, I found this project a good learning opportunity that taught me a lot about low-level microcontroller code. This project helped me understand how the microcontroller interprets the functions that I write to it in normal Arduino code. It gave me a certain level of respect for those who write the functions that help beginners learn the basics of coding and keep them motivated. This project also taught me the &quot;low-level&quot; equivalent of LED matrices, wherein the LEDs have to be arranged in a certain way and the leads have to be kept separate in order to have the matrix work as intended. I am happy to have overcome the challenges I had in this project and am excited to bring my newfound knowledge with me for use in future endeavours. </p><h2>Reference</h2><p>D&#x27;Arcy, Chris. &quot;2016-2017 TEI3M Challenges - BiColor LED Matrix.&quot; RSGC ACES, RSGC, <a href="http://darcy.rsgc.on.ca/ACES/TEI3M/1617/Challenges.html#BiColorLEDMatrix">http://darcy.rsgc.on.ca/ACES/TEI3M/1617/Challenges.html#BiColorLEDMatrix</a>. Accessed 29 Apr. 2017.</p></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"BiColour LED Matrix","name":"2017-04-30-BiColour-LED-Matrix","content":{"compiledSource":"var c=Object.defineProperty,h=Object.defineProperties;var d=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;var l=(e,s,n)=\u003es in e?c(e,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[s]=n,a=(e,s)=\u003e{for(var n in s||(s={}))r.call(s,n)\u0026\u0026l(e,n,s[n]);if(p)for(var n of p(s))o.call(s,n)\u0026\u0026l(e,n,s[n]);return e},i=(e,s)=\u003eh(e,d(s));var m=(e,s)=\u003e{var n={};for(var t in e)r.call(e,t)\u0026\u0026s.indexOf(t)\u003c0\u0026\u0026(n[t]=e[t]);if(e!=null\u0026\u0026p)for(var t of p(e))s.indexOf(t)\u003c0\u0026\u0026o.call(e,t)\u0026\u0026(n[t]=e[t]);return n};const layoutProps={},MDXLayout=\"wrapper\";function MDXContent(n){var t=n,{components:e}=t,s=m(t,[\"components\"]);return mdx(MDXLayout,i(a(a({},layoutProps),s),{components:e,mdxType:\"MDXLayout\"}),mdx(\"h2\",null,\"Purpose\"),mdx(\"p\",null,\"The purpose of this project is to learn about low-level port manipulation using the ATtiny84 and a homemade bicolour LED matrix display. The LED matrix is to show a unique and challenging pattern. This project incorporates persistence of vision (POV), switching quickly between red and green to create a yellow colour and code that uses bitwise operators. The animations used will consist of a square counting down from four to zero, then a red dot flashing in sync with a buzzer; a series of firework-like explosion animations wherein the LEDs flash outwards in a cross from an origin; and a yellow sunrise and sunset animation.\"),mdx(\"table\",null,mdx(\"thead\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"thead\"},mdx(\"th\",a({parentName:\"tr\"},{align:null}),\"Parts List\"),mdx(\"th\",a({parentName:\"tr\"},{align:null})))),mdx(\"tbody\",{parentName:\"table\"},mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"ATtiny84 Through-Hole Microcontroller\"),mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"16 \\xD7 Red-Green BiColour LEDs\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"Piezo buzzer\"),mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"AVR Pocket Programmer\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"AVR Programmer Breakout Board\"),mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"Heat-Shrink Tubing\")),mdx(\"tr\",{parentName:\"tbody\"},mdx(\"td\",a({parentName:\"tr\"},{align:null}),\"4 \\xD7 Male to Female Jumper Wires\"),mdx(\"td\",a({parentName:\"tr\"},{align:null}))))),mdx(\"h2\",null,\"Procedure\"),mdx(\"p\",null,'This project begins by soldering the LED matrix together using the 3D-Printed matrix jig (seen bottom right). The arrangement of the LEDs requires them to be in a particular orientation as to connect all the short pins and long pins together. They must be in this arrangement so that the code can address individual LEDs. Heat shrink tubing on each of the anode pins prevents them from short-circuiting with the bare cathode pins soldered beneath and displaying a unwanted pattern. Building the matrix requires the testing of each LED to ensure operation and prevent non-functional \"pixels\" on the matrix. Coloured heat shrink tubing added to the ends of the matrix pins differentiate the anode pins of each colour.'),mdx(\"p\",null,\"The code consists of four separate patterns: \",mdx(\"inlineCode\",{parentName:\"p\"},\"countDownSquare()\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"explodeMatrix()\"),\", \",mdx(\"inlineCode\",{parentName:\"p\"},\"sunrise()\"),\",\",mdx(\"inlineCode\",{parentName:\"p\"},\"sunset()\"),\". Code uploading utilizes the AVR Pocket Programmer.\"),mdx(\"img\",{style:{float:\"right\"},src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/GarrowJig.png\"}),'To begin, the `countDownSquare()` function displays a 2\\xD72 square of green LEDs in the middle of the matrix. The function then uses POV to iterate through a series of display outputs. The POV used in this project utilizes the ability to set each individual port on each individual bus to input or output using the Data Direction Register (DDR). When a pin is set to output, it is either ground or VCC. When it is set to input, however, it is essentially \"hanging\" and will not ground or supply any voltage. This is how it is possible to individually address LEDs. The function continues the countdown, and then shows a blinking red LED in conjunction with a buzzer.',mdx(\"img\",{style:{float:\"right\"},src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/Screen%20Shot%202018-01-31%20at%2011.46.12.png\"}),'The `explodeMatrix()` function is a special loop that calls the main `fireworks()` function with every individual LED as an origin point. The `fireworks()` function iterates through a loop itself where it fills the matrix with a specific colour, but uses the DDR to disable particular LEDs. The function uses the logical OR operator (see Project 2) on each individual bit (called bitwise) to calculate the required value in the DDR and show only the requested LED. By adding the loop variable to the specified `startingLEDY` and `startingLEDX`, the loop uses POV to light up LEDs in a outward moving \"cross\" pattern, thus simulating a firework-like explosion.',mdx(\"p\",null,\"Finally, the \",mdx(\"inlineCode\",{parentName:\"p\"},\"sunrise()\"),\" function utilises the \",mdx(\"inlineCode\",{parentName:\"p\"},\"sunriseDDR[]\"),\" array to demonstrate that arrays can store patterns. First, the program iterates through a \",mdx(\"inlineCode\",{parentName:\"p\"},\"while()\"),\" to ensure that specific display values appear for an accurate duration of time. The \",mdx(\"inlineCode\",{parentName:\"p\"},\"countDownSquare()\"),\" function uses a similar loop to display POV patterns. The \",mdx(\"inlineCode\",{parentName:\"p\"},\"while()\"),\" loop iterates through each element setting DDRA equal to the value of said element. Using the \",mdx(\"inlineCode\",{parentName:\"p\"},\"sunriseFrames\"),\" variable in the loop prevents it from exceeding the maximum length of the array and breaking the pattern. To finish, the code iterates through the \",mdx(\"inlineCode\",{parentName:\"p\"},\"sunriseDDR[]\"),\" array in reverse to show the sunset animation. The code then loops through the four patterns again.\"),mdx(\"h2\",null,\"Media\"),mdx(\"table\",null,mdx(\"tr\",null,mdx(\"td\",null,mdx(\"img\",{src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0001.jpg\"})),mdx(\"td\",null,mdx(\"img\",{src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0002.jpg\"}))),mdx(\"tr\",null,mdx(\"th\",null,\"Testing patterns on the matrix\"),mdx(\"th\",null,mdx(\"code\",null,\"countDownSquare()\"),\" animation\")),mdx(\"tr\",null,mdx(\"td\",null,mdx(\"img\",{src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/20170427_213007.jpg\"})),mdx(\"td\",null,mdx(\"img\",{src:\"/assets/img/ER%20Reports/Grade%2011/BiColour%20LED%20Matrix/DSC_0006.jpg\"}))),mdx(\"tr\",null,mdx(\"th\",null,\"AVR Programmer Breakout Board properly assembled\"),mdx(\"th\",null,\"Final solder job of the BiColour LED Matrix\")),mdx(\"tr\",null,mdx(\"th\",{colSpan:\"2\"},\"Link to YouTube Video: \",mdx(\"a\",{href:\"https://youtu.be/hrjuC2itXW4\"},\"https://youtu.be/hrjuC2itXW4\")))),mdx(\"h2\",null,\"Code\"),mdx(\"pre\",null,mdx(\"code\",a({parentName:\"pre\"},{className:\"hljs language-arduino\"}),mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-meta\"}),\"#\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-keyword\"}),\"define\"),\" RED 1\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" sunriseDDR[] = {\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x16\"),\", \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x36\"),\", \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x36\"),\", \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x66\"),\", \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xC6\"),\"};\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//sunrise value array\"),`\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" sunriseFrames = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"sizeof\"),\"(sunriseDDR) / \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"sizeof\"),\"(\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\"); \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//calculates length of sunrise array in bytes\"),`\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"setup\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),`{\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xFF\"),\";\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//preemptively enables output for all matrix ports\"),`\n  DDRB = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c PORTB2;\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//enables specific port on PORTB for buzzer\"),`\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"loop\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),`{\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"countDownSquare\"),\"(\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"100\"),`);\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"explodeMatrix\"),`();\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"sunrise\"),\"(\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"100\"),`);\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"sunset\"),\"(\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"100\"),`);\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"countDownSquare\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"(\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint16_t\"),\" countSpeed)\"),\" \"),`{\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x66\"),`;\n  PORTA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x60\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//full green square\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"delay\"),`(countSpeed);\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint16_t\"),\" povTime = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`();\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"while\"),\" (povTime + \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"200\"),\" \u003e= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),\"()) { \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//shows POV of 3 dots in centre of matrix\"),`\n    DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x22\"),`;\n    PORTA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x20\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//bottom left green dot\"),`\n    DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x64\"),`;\n    PORTA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x60\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//two green line left\"),`\n  }\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x64\"),\";\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//shows 2 dots on left side of matrix\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"delay\"),`(countSpeed);\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x44\"),\";\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"// shows upper left dot\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"delay\"),`(countSpeed);\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x44\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"// keeps red dot in sync with other dots to be displayed\"),`\n  PORTA ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xFF\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//invert colours of top left dot\"),`\n  DDRA ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),` \u003c\u003c PORTA2;\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" i; i \u003c \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"8\"),`; i++) {\n    PORTB ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c PORTB2;\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//turns on and off the buzzer\"),`\n    DDRA ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c PORTA2; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//turn on and off the top left dot\"),`\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"delay\"),`(countSpeed);\n  }\n  DDRB = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x00\"),\"; \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//turn off port as interference from other ports can cause noise in the buzzer\"),`\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"firework\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"(\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint8_t\"),\" explosionSpeed, \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint8_t\"),\" startingLEDY, \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint8_t\"),\" startingLEDX)\"),\" \"),`{\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"matrix\"),`(RED);\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" i = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0\"),\"; i \u003c= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"4\"),`; i++) {\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint16_t\"),\" povDuration = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`() + explosionSpeed;\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"while\"),\" (povDuration \u003e= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),\"()) { \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),'// uses POV and loop to show \"explosion\" animation where lit LEDs move out in a cross from the original LED'),`\n      DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c startingLEDY + i | \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),` \u003c\u003c startingLEDX;\n      DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c startingLEDY - i | \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),` \u003c\u003c startingLEDX;\n      DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c startingLEDY | \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),` \u003c\u003c startingLEDX + i;\n      (startingLEDX - i) \u003c `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0\"),\" ? DDRA = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x00\"),\" : DDRA = (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c startingLEDY | \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" \u003c\u003c startingLEDX - i); \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"// if conditional is not used, the LED linked to PORTA0 will stay on, as negatives are not accepted\"),`\n    }\n  }\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"matrix\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"(\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint8_t\"),\" colour)\"),\" \"),\"{ \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//sets matrix either all green or all red\"),`\n  colour == `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\" ? PORTA = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x0F\"),\" : PORTA = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xF0\"),`;\n}\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"explodeMatrix\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"()\"),\" \"),\"{ \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//runs through a loop of firework animations; one animation per led on the matrix\"),`\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" i = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0\"),\"; i \u003c= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"3\"),`; i++) {\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" j = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"4\"),\"; j \u003c= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"7\"),`; j++) {\n      `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"firework\"),\"(\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"40\"),`, j, i);\n    }\n  }\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"sunrise\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"(\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint16_t\"),\" duration)\"),\" \"),\"{ \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"// animates sunrise array\"),`\n  PORTA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x0F\"),`;\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" i = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0\"),`; i \u003c sunriseFrames; i++) {\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint16_t\"),\" povTime = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`() + duration;\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"while\"),\" (povTime \u003e \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`()) {\n      DDRA = sunriseDDR[i];`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//loops through array and displays appropriate value\"),`\n      PORTA ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xFF\"),`;\n    }\n  }\n}\n\n`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-function\"}),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"void\"),\" \",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-title\"}),\"sunset\"),mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-params\"}),\"(\",mdx(\"span\",a({parentName:\"span\"},{className:\"hljs-type\"}),\"uint16_t\"),\" duration)\"),\" \"),`{\n  PORTA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x0F\"),`;\n  `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"for\"),\" (\",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint8_t\"),\" i = sunriseFrames - \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"1\"),\"; i \u003e= \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0\"),`; i--) {\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-type\"}),\"uint16_t\"),\" povTime = \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`() + duration;\n    `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-keyword\"}),\"while\"),\" (povTime \u003e \",mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-built_in\"}),\"millis\"),`()) {\n      DDRA = sunriseDDR[i];`,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-comment\"}),\"//loops through array and displays appropriate value\"),`\n      PORTA ^= `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0xFF\"),`;\n    }\n  }\n  DDRA = `,mdx(\"span\",a({parentName:\"code\"},{className:\"hljs-number\"}),\"0x00\"),`;\n}\n`)),mdx(\"h2\",null,\"Conclusion\"),mdx(\"p\",null,'In conclusion, I found this project a good learning opportunity that taught me a lot about low-level microcontroller code. This project helped me understand how the microcontroller interprets the functions that I write to it in normal Arduino code. It gave me a certain level of respect for those who write the functions that help beginners learn the basics of coding and keep them motivated. This project also taught me the \"low-level\" equivalent of LED matrices, wherein the LEDs have to be arranged in a certain way and the leads have to be kept separate in order to have the matrix work as intended. I am happy to have overcome the challenges I had in this project and am excited to bring my newfound knowledge with me for use in future endeavours.\\u2003'),mdx(\"h2\",null,\"Reference\"),mdx(\"p\",null,`D'Arcy, Chris. \"2016-2017 TEI3M Challenges - BiColor LED Matrix.\" RSGC ACES, RSGC, `,mdx(\"a\",a({parentName:\"p\"},{href:\"http://darcy.rsgc.on.ca/ACES/TEI3M/1617/Challenges.html#BiColorLEDMatrix\"}),\"http://darcy.rsgc.on.ca/ACES/TEI3M/1617/Challenges.html#BiColorLEDMatrix\"),\". Accessed 29 Apr. 2017.\"))}MDXContent.isMDXComponent=!0;\n","scope":{}}}},"__N_SSG":true},"page":"/blog/[postName]","query":{"postName":"2017-04-30-BiColour-LED-Matrix"},"buildId":"5zUs8AefGgLCYwo_St8mR","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>